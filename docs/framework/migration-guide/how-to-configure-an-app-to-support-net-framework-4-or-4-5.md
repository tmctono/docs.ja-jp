---
title: '方法: .NET Framework 4 以降のバージョンをサポートするアプリを構成する'
description: 含まれる例を使用し、.NET Framework 4 以降をサポートするようにデスクトップ アプリを構成する方法について学習します。
ms.date: 03/30/2017
helpviewer_keywords:
- configuring apps to support .NET Framework
- .NET Framework, configuring apps
ms.assetid: 63c6b9a8-0088-4077-9aa3-521ab7290f79
ms.openlocfilehash: 58d71cb7fac7a3c2bef975c99cfab1ca730fb6eb
ms.sourcegitcommit: cf5a800a33de64d0aad6d115ffcc935f32375164
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/20/2020
ms.locfileid: "86475464"
---
# <a name="how-to-configure-an-app-to-support-net-framework-4-or-later-versions"></a><span data-ttu-id="e7321-103">方法: .NET Framework 4 以降のバージョンをサポートするアプリを構成する</span><span class="sxs-lookup"><span data-stu-id="e7321-103">How to: Configure an App to Support .NET Framework 4 or later versions</span></span>

<span data-ttu-id="e7321-104">共通言語ランタイム (CLR) をホストするすべてのアプリでは、マネージド コードを実行するために CLR を開始または*アクティブ化*する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7321-104">All apps that host the common language runtime (CLR) need to start, or *activate*, the CLR in order to run managed code.</span></span> <span data-ttu-id="e7321-105">通常、.NET Framework アプリはビルドされた CLR のバージョンで実行されますが、アプリケーション構成ファイル (app.config ファイルと呼ばれることもあります) を使用して、デスクトップ アプリのこの動作を変更できます。</span><span class="sxs-lookup"><span data-stu-id="e7321-105">Typically, a .NET Framework app runs on the version of the CLR that it was built on, but you can change this behavior for desktop apps by using an application configuration file (sometimes referred to as an app.config file).</span></span> <span data-ttu-id="e7321-106">ただし、アプリケーション構成ファイルを使用して Windows ストア アプリまたは Windows Phone アプリの既定のアクティベーション動作は変更できません。</span><span class="sxs-lookup"><span data-stu-id="e7321-106">However, you cannot change the default activation behavior for Windows Store apps or Windows Phone apps by using an application configuration file.</span></span> <span data-ttu-id="e7321-107">この記事では、デスクトップ アプリを .NET Framework の別のバージョンで実行できるようにする方法を説明し、バージョン 4 以降を対象とする方法の例を示します。</span><span class="sxs-lookup"><span data-stu-id="e7321-107">This article explains how to enable your desktop app to run on another version of the .NET Framework and provides an example of how to target version 4 or later versions.</span></span>

 <span data-ttu-id="e7321-108">アプリが実行される .NET Framework のバージョンは、次の順序で決まります。</span><span class="sxs-lookup"><span data-stu-id="e7321-108">The version of the .NET Framework that an app runs on is determined in the following order:</span></span>

- <span data-ttu-id="e7321-109">構成ファイル。</span><span class="sxs-lookup"><span data-stu-id="e7321-109">Configuration file.</span></span>

     <span data-ttu-id="e7321-110">アプリケーション構成ファイルに 1 つ以上の .NET Framework のバージョンを指定する [\<supportedRuntime>](../configure-apps/file-schema/startup/supportedruntime-element.md) エントリがあり、これらのバージョンの 1 つがユーザーのコンピューターにある場合、アプリはそのバージョンで実行されます。</span><span class="sxs-lookup"><span data-stu-id="e7321-110">If the application configuration file includes [\<supportedRuntime>](../configure-apps/file-schema/startup/supportedruntime-element.md) entries that specify one or more .NET Framework versions, and one of those versions is present on the user's computer, the app runs on that version.</span></span> <span data-ttu-id="e7321-111">構成ファイルは、一覧表示された順序で [\<supportedRuntime>](../configure-apps/file-schema/startup/supportedruntime-element.md) エントリを読み込み、ユーザーのコンピューターにある、最初に表示される .NET Framework バージョンを使用します。</span><span class="sxs-lookup"><span data-stu-id="e7321-111">The configuration file reads [\<supportedRuntime>](../configure-apps/file-schema/startup/supportedruntime-element.md) entries in the order they are listed, and uses the first .NET Framework version listed that is present on the user's computer.</span></span> <span data-ttu-id="e7321-112">(バージョン 1.0 には [\<requiredRuntime> 要素](../configure-apps/file-schema/startup/requiredruntime-element.md)を使用します。)</span><span class="sxs-lookup"><span data-stu-id="e7321-112">(Use the [\<requiredRuntime> element](../configure-apps/file-schema/startup/requiredruntime-element.md) for version 1.0.)</span></span>

- <span data-ttu-id="e7321-113">コンパイル後のバージョン。</span><span class="sxs-lookup"><span data-stu-id="e7321-113">Compiled version.</span></span>

     <span data-ttu-id="e7321-114">構成ファイルがなく、アプリがビルドされた .NET Framework のバージョンがユーザーのコンピューターに存在する場合、アプリはそのバージョンで実行されます。</span><span class="sxs-lookup"><span data-stu-id="e7321-114">If there is no configuration file, but the version of the .NET Framework that the app was built on is present on the user's computer, the app runs on that version.</span></span>

- <span data-ttu-id="e7321-115">インストールされた最新バージョン。</span><span class="sxs-lookup"><span data-stu-id="e7321-115">Latest version installed.</span></span>

     <span data-ttu-id="e7321-116">アプリがビルドされた .NET Framework のバージョンがなく、構成ファイルの [\<supportedRuntime> 要素](../configure-apps/file-schema/startup/supportedruntime-element.md)でバージョンが指定されていない場合、アプリはユーザーのコンピューターにある .NET Framework の最新バージョンで実行が試みられます。</span><span class="sxs-lookup"><span data-stu-id="e7321-116">If the version of the .NET Framework that the app was built on is not present and a configuration file does not specify a version in a [\<supportedRuntime> element](../configure-apps/file-schema/startup/supportedruntime-element.md), the app tries to run on the latest version of the .NET Framework that is present on the user's computer.</span></span>

     <span data-ttu-id="e7321-117">ただし、.NET Framework 1.0、1.1、2.0、3.0、および 3.5 のアプリは、.NET Framework 4 以降では自動的に実行されず、場合によっては、エラーが発生し、.NET Framework 3.5 をインストールするように求めるメッセージが表示されることがあります。</span><span class="sxs-lookup"><span data-stu-id="e7321-117">However, .NET Framework 1.0, 1.1, 2.0, 3.0, and 3.5 apps do not automatically run on the .NET Framework 4 or later, and in some cases, the user may receive an error and may be prompted to install the .NET Framework 3.5.</span></span> <span data-ttu-id="e7321-118">また、Windows システムの異なるバージョンには .NET Framework の異なるバージョンが含まれるので、アクティベーション動作はユーザーのオペレーティング システムに応じて異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="e7321-118">The activation behavior may also depend on the user’s operating system, because  different versions of Windows system include different versions of the .NET Framework.</span></span> <span data-ttu-id="e7321-119">アプリが .NET Framework 3.5 と 4、またはそれ以降をサポートしている場合は、構成ファイルの複数のエントリでこれを示して .NET Framework 初期化エラーを回避することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="e7321-119">If your app supports both the .NET Framework 3.5 and 4 or later, we recommend that you indicate this with multiple entries in the configuration file to avoid .NET Framework initialization errors.</span></span> <span data-ttu-id="e7321-120">詳細については、「[.NET Framework のバージョンおよび依存関係](versions-and-dependencies.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e7321-120">For more information, see [Versions and Dependencies](versions-and-dependencies.md).</span></span>

 <span data-ttu-id="e7321-121">また、.NET Framework 3.5 がコンピューターにインストールされている場合でも、.NET Framework 4 以降のバージョンで実行できるように .NET Framework 3.5 アプリを構成して、Version 4 以降のバージョンのパフォーマンス向上を活用することもできます。</span><span class="sxs-lookup"><span data-stu-id="e7321-121">You might also want to configure your .NET Framework 3.5 apps to run on the .NET Framework 4 or later versions, even on computers that have the .NET Framework 3.5 installed, to take advantage of the performance improvements in versions 4 and later versions.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e7321-122">サポートするすべての .NET Framework のバージョンで必ずアプリをテストすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="e7321-122">We recommend that you always test your app on every .NET Framework version that you support.</span></span> <span data-ttu-id="e7321-123">以降の .NET Framework のバージョンをサポートするためのアプリケーションのアップグレードについての詳細は、「[.NET Framework のバージョンの互換性](version-compatibility.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e7321-123">See [Version Compatibility](version-compatibility.md) for information about upgrading your application to support later .NET Framework versions.</span></span>

 <span data-ttu-id="e7321-124">.NET Framework 1.0 および 1.1 アプリを変更して Windows 7 と Windows 8 をサポートする方法の詳細については、「[.NET Framework 1.1 からの移行](migrating-from-the-net-framework-1-1.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e7321-124">For information about modifying your .NET Framework 1.0 and 1.1 apps to support Windows 7 and Windows 8, see [Migrating from the .NET Framework 1.1](migrating-from-the-net-framework-1-1.md).</span></span>

## <a name="to-configure-your-app-to-run-on-the-net-framework-4-or-later-versions"></a><span data-ttu-id="e7321-125">.NET Framework 4 以降のバージョンで実行できるようにアプリを構成するには</span><span class="sxs-lookup"><span data-stu-id="e7321-125">To configure your app to run on the .NET Framework 4 or later versions</span></span>

1. <span data-ttu-id="e7321-126">.NET Framework プロジェクトの構成ファイルを追加または検索します。</span><span class="sxs-lookup"><span data-stu-id="e7321-126">Add or locate the configuration file for the .NET Framework project.</span></span> <span data-ttu-id="e7321-127">アプリの構成ファイルは、同じディレクトリにあり、アプリと同じ名前ですが、.config 拡張子があります。</span><span class="sxs-lookup"><span data-stu-id="e7321-127">The configuration file for an app is in the same directory and has the same name as the app, but has a .config extension.</span></span> <span data-ttu-id="e7321-128">たとえば、アプリが MyExecutable.exe という名前であれば、アプリケーション構成ファイルの名前は MyExecutable.exe.config です。</span><span class="sxs-lookup"><span data-stu-id="e7321-128">For example, for an app named MyExecutable.exe, the application configuration file is named MyExecutable.exe.config.</span></span>

     <span data-ttu-id="e7321-129">構成ファイルを追加するには、Visual Studio のメニュー バーで **[プロジェクト]** 、 **[新しい項目の追加]** の順にクリックします。</span><span class="sxs-lookup"><span data-stu-id="e7321-129">To add a configuration file, on the Visual Studio menu bar, choose **Project**, **Add New Item**.</span></span> <span data-ttu-id="e7321-130">左ペインで **[全般]** をクリックし、 **[構成ファイル]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="e7321-130">Choose **General** from the left pane, and then choose **Configuration File**.</span></span> <span data-ttu-id="e7321-131">構成ファイルに *appName*.exe.config という名前を付けます。これらのメニューの選択は、Windows ストア アプリ プロジェクトまたは Windows phone アプリ プロジェクトでは使用できません。これらのプラットフォームのアクティベーション ポリシーを変更できないためです。</span><span class="sxs-lookup"><span data-stu-id="e7321-131">Name the configuration file *appName*.exe.config. These menu choices are not available for Windows Store app or Windows phone app projects, because you cannot change the activation policy on those platforms.</span></span>

2. <span data-ttu-id="e7321-132">次のように、アプリケーション構成ファイルに [\<supportedRuntime>](../configure-apps/file-schema/startup/supportedruntime-element.md) 要素を追加します。</span><span class="sxs-lookup"><span data-stu-id="e7321-132">Add the [\<supportedRuntime>](../configure-apps/file-schema/startup/supportedruntime-element.md) element as follows to the application configuration file:</span></span>

    ```xml
    <configuration>
      <startup>
        <supportedRuntime version="version"/>
      </startup>
    </configuration>
    ```

     <span data-ttu-id="e7321-133">*\<version>* が、アプリがサポートする .NET Framework のバージョンに合わせて CLR バージョンを指定する場合。</span><span class="sxs-lookup"><span data-stu-id="e7321-133">where *\<version>* specifies the CLR version that aligns with the .NET Framework version that your app supports.</span></span> <span data-ttu-id="e7321-134">次の文字列を使用します。</span><span class="sxs-lookup"><span data-stu-id="e7321-134">Use the following strings:</span></span>

    - <span data-ttu-id="e7321-135">.NET Framework 1.0: 「v1.0.3705」</span><span class="sxs-lookup"><span data-stu-id="e7321-135">.NET Framework 1.0: "v1.0.3705"</span></span>

    - <span data-ttu-id="e7321-136">.NET Framework 1.1: 「v1.1.4322」</span><span class="sxs-lookup"><span data-stu-id="e7321-136">.NET Framework 1.1: "v1.1.4322"</span></span>

    - <span data-ttu-id="e7321-137">.NET Framework 2.0、3.0、および 3.5: 「v2.0.50727」</span><span class="sxs-lookup"><span data-stu-id="e7321-137">.NET Framework 2.0, 3.0, and 3.5: "v2.0.50727"</span></span>

    - <span data-ttu-id="e7321-138">.NET Framework 4 以降のバージョン: "v4.0"</span><span class="sxs-lookup"><span data-stu-id="e7321-138">.NET Framework 4 and later versions: "v4.0"</span></span>

     <span data-ttu-id="e7321-139">複数の [\<supportedRuntime>](../configure-apps/file-schema/startup/supportedruntime-element.md) 要素を優先順に追加して、複数バージョンの .NET Framework のサポートを指定できます。</span><span class="sxs-lookup"><span data-stu-id="e7321-139">You can add multiple [\<supportedRuntime>](../configure-apps/file-schema/startup/supportedruntime-element.md) elements, listed in order of preference, to specify support for multiple versions of the .NET Framework.</span></span>

 <span data-ttu-id="e7321-140">アプリケーション構成ファイルの設定およびコンピューターにインストールされている .NET Framework のバージョンによって、.NET Framework 3.5 アプリが実行されるバージョンがどのように決定されるかを次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="e7321-140">The following table demonstrates how application configuration file settings and the .NET Framework versions installed on a computer determine the version that a .NET Framework 3.5 app runs on.</span></span> <span data-ttu-id="e7321-141">この例は、.NET Framework 3.5 のアプリケーションに固有ですが、以前の .NET Framework バージョンで作成されたアプリケーションを対象にする場合も同様のロジックを使用できます。</span><span class="sxs-lookup"><span data-stu-id="e7321-141">The examples are specific to a .NET Framework 3.5 application, but you can use similar logic to target applications built with earlier .NET Framework versions.</span></span> <span data-ttu-id="e7321-142">アプリケーション構成ファイルで .NET Framework 3.5 を指定するために、.NET Framework 2.0 のバージョン番号 (v2.0.50727) が使用されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="e7321-142">Note that the .NET Framework 2.0 version number (v2.0.50727) is used to specify the .NET Framework 3.5 in the application configuration file.</span></span>

|<span data-ttu-id="e7321-143">App.config ファイルの設定</span><span class="sxs-lookup"><span data-stu-id="e7321-143">App.config file setting</span></span>|<span data-ttu-id="e7321-144">バージョン 3.5 がインストールされているコンピューター</span><span class="sxs-lookup"><span data-stu-id="e7321-144">On computer with version 3.5 installed</span></span>|<span data-ttu-id="e7321-145">3\.5、4、それ以降のバージョンがインストールされているコンピューター</span><span class="sxs-lookup"><span data-stu-id="e7321-145">On computer with versions 3.5 and 4 or later versions installed</span></span>|<span data-ttu-id="e7321-146">4 以降のバージョンがインストールされているコンピューター</span><span class="sxs-lookup"><span data-stu-id="e7321-146">On computer with version 4 or later versions installed</span></span>|
|-|-|-|-|
|<span data-ttu-id="e7321-147">None</span><span class="sxs-lookup"><span data-stu-id="e7321-147">None</span></span>|<span data-ttu-id="e7321-148">3\.5 で動作</span><span class="sxs-lookup"><span data-stu-id="e7321-148">Runs on 3.5</span></span>|<span data-ttu-id="e7321-149">3\.5 で動作</span><span class="sxs-lookup"><span data-stu-id="e7321-149">Runs on 3.5</span></span>|<span data-ttu-id="e7321-150">ユーザーに正しいバージョン \* をインストールするように求めるエラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="e7321-150">Displays error message that prompts user to install the correct version\*</span></span>|
|`<supportedRuntime version="v2.0.50727"/>`|<span data-ttu-id="e7321-151">3\.5 で動作</span><span class="sxs-lookup"><span data-stu-id="e7321-151">Runs on 3.5</span></span>|<span data-ttu-id="e7321-152">3\.5 で動作</span><span class="sxs-lookup"><span data-stu-id="e7321-152">Runs on 3.5</span></span>|<span data-ttu-id="e7321-153">ユーザーに正しいバージョン \* をインストールするように求めるエラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="e7321-153">Displays error message that prompts user to install the correct version\*</span></span>|
|`<supportedRuntime version="v2.0.50727"/>` <br /> `<supportedRuntime version="v4.0"/>`|<span data-ttu-id="e7321-154">3\.5 で動作</span><span class="sxs-lookup"><span data-stu-id="e7321-154">Runs on 3.5</span></span>|<span data-ttu-id="e7321-155">3\.5 で動作</span><span class="sxs-lookup"><span data-stu-id="e7321-155">Runs on 3.5</span></span>|<span data-ttu-id="e7321-156">4 以降のバージョンで動作</span><span class="sxs-lookup"><span data-stu-id="e7321-156">Runs on 4 or later versions</span></span>|
|`<supportedRuntime version="v4.0"/>` <br /> `<supportedRuntime version="v2.0.50727"/>`|<span data-ttu-id="e7321-157">3\.5 で動作</span><span class="sxs-lookup"><span data-stu-id="e7321-157">Runs on 3.5</span></span>|<span data-ttu-id="e7321-158">4 以降のバージョンで動作</span><span class="sxs-lookup"><span data-stu-id="e7321-158">Runs on 4 or later versions</span></span>|<span data-ttu-id="e7321-159">4 以降のバージョンで動作</span><span class="sxs-lookup"><span data-stu-id="e7321-159">Runs on 4 or later versions</span></span>|
|`<supportedRuntime version="v4.0"/>`|<span data-ttu-id="e7321-160">ユーザーに正しいバージョン \* をインストールするように求めるエラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="e7321-160">Displays error message that prompts user to install the correct version\*</span></span>|<span data-ttu-id="e7321-161">4 以降のバージョンで動作</span><span class="sxs-lookup"><span data-stu-id="e7321-161">Runs on 4 or later versions</span></span>|<span data-ttu-id="e7321-162">4 以降のバージョンで動作</span><span class="sxs-lookup"><span data-stu-id="e7321-162">Runs on 4 or later versions</span></span>|

 <span data-ttu-id="e7321-163">\* このエラー メッセージの詳細と回避方法については、「[.NET Framework 初期化エラー: ユーザー エクスペリエンスの管理](../deployment/initialization-errors-managing-the-user-experience.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e7321-163">\* For more information about this error message and ways to avoid it, see [.NET Framework Initialization Errors: Managing the User Experience](../deployment/initialization-errors-managing-the-user-experience.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="e7321-164">関連項目</span><span class="sxs-lookup"><span data-stu-id="e7321-164">See also</span></span>

- [<span data-ttu-id="e7321-165">.NET Framework 1.1 からの移行</span><span class="sxs-lookup"><span data-stu-id="e7321-165">Migrating from the .NET Framework 1.1</span></span>](migrating-from-the-net-framework-1-1.md)
- [<span data-ttu-id="e7321-166">移行ガイド</span><span class="sxs-lookup"><span data-stu-id="e7321-166">Migration Guide</span></span>](index.md)
